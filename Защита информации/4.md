### Системы обнаружения атак. Средства защиты от атак на информацию: межсетевые экраны, на уровне протоколов.
Эффективность системы обнаружения атак во многом зависит от применяемых методов анализа полученной информации. В настоящее время к статистическому анализу добавился ряд новых методик, начиная с экспертных систем и нечеткой логики и заканчивая использованием нейронных сетей.

**Статистический метод**. Основные преимущества статистического подхода — использование уже разработанного и зарекомендовавшего себя аппарата математической статистики и адаптация к поведению субъекта. Сначала для всех субъектов анализируемой системы определяются профили. Любое отклонение используемого профиля от* эталонного считается несанкционированной деятельностью. Статистические методы универсальны, поскольку для проведения анализа не требуется знания о возможных атаках и используемых ими уязвимостях

**Экспертные системы** состоят из набора правил, которые охватывают знания человека-эксперта. Использование экспертных систем представляет собой распространенный метод обнаружения атак, при котором информация об атаках формулируется в виде правил. Эти правила могут быть записаны, например, в виде последовательности действий или в виде сигнатуры. При выполнении любого из этих правил принимается решение о наличии несанкционированной деятельности. Важным достоинством такого подхода является практически полное отсутствие ложных тревог. БД экспертной системы должна содержать сценарии большинства известных на сегодняшний день атак. Для того чтобы оставаться постоянно актуальными, экспертные системы требу ют постоянного обновления БД. 

**Нейронные сети**. Большинство современных методов обнаружения атак используют некоторую форму анализа контролируемого пространства на основе правил или статистического подхода. В качестве контролируемого пространства могут выступать журналы регистрации или сетевой трафик. Анализ опирается на набор заранее определенных правил, которые создаются администратором или самой системой обнаружения атак.
Любое разделение атаки во времени или среди нескольких злоумышленников является трудным для обнаружения при по мощи экспертных систем. Из-за большого разнообразия атак и хакеров даже специальные постоянные обновления БД правил экспертной системы никогда не дадут гарантии точной идентификации всего диапазона атак. Использование нейронных сетей является одним из способов преодоления указанных проблем экспертных систем. В отличие от экспертных систем, которые могут дать пользователю определенный ответ о соответствии рассматриваемых характеристик заложенным в БД правилам, нейронная сеть проводит анализ информации и предоставляет возможность оценить, согласуются ли данные с характеристиками, которые она научена распознавать. В то время как степень соответствия нейросетевого представления может достигать 100 %, достоверность выбора полностью зависит от качества системы в анализе примеров по ставленной задачи.

**Межсетевой экран (МЭ)** — это специализированный комплекс межсетевой защиты, называемый также брандмауэром или системой firewall. МЭ позволяет разделить общую сеть на две части (или более) и реализовать набор правил, определяющих условия прохождения пакетов с данными через границу из одной части общей сети в другую. Как правило, эта граница про водится между корпоративной (локальной) сетью предприятия и глобальной сетью Internet. Обычно МЭ защищают внутреннюю сеть предприятия от «вторжений» из глобальной сети Internet, хотя они могут использоваться и для защиты от «нападений» из корпоративной интрасети, к которой подключена локальная сеть предприятия. Технология МЭ одна из самых первых технологий защиты корпоративных сетей от внешних угроз.

МЭ поддерживают безопасность межсетевого взаимодействия на различных уровнях модели OSI. При этом функции за щиты, выполняемые на разных уровнях эталонной модели, существенно отличаются друг от друга. Поэтому комплексный МЭ удобно представить в виде совокупности неделимых экранов, каждый из которых ориентирован на отдельный уровень модели OSI. Чаще всего комплексный экран функционирует на сетевом, сеансовом и прикладном уровнях эталонной модели. Соответственно различают такие неделимые МЭ (рис. 9.5), как: 
• экранирующий маршрутизатор; 
• шлюз сеансового уровня (экранирующий транспорт); 
• шлюз прикладного уровня (экранирующий шлюз) 
![[Pasted image 20250804214953.png]]

1. **Прикладной шлюз**. Прикладной шлюз, называемый также экранирующим шлюзом, функционирует на прикладном уровне модели OSI, охватывая также уровень представления, и обеспечивает наиболее надежную защиту межсетевых взаимодействий. Защитные функции прикладного шлюза, как и шлюза сеансового уровня, относятся к функциям посредничества. Однако прикладной шлюз, в отличие от шлюза сеансового уровня, может выполнять существенно большее количество функций защиты, к которым относятся следующие: 
	• идентификация и аутентификация пользователей при по пытке установления соединений через МЭ; 
	• проверка подлинности информации, передаваемой через шлюз; 
	• разграничение доступа к ресурсам внутренней и внешней сетей; 
	• фильтрация и преобразование потока сообщений, напри мер динамический поиск вирусов и прозрачное шифрование информации; 
	• регистрация событий, реагирование на задаваемые события, а также анализ зарегистрированной информации и генерация отчетов; 
	• кэширование данных, запрашиваемых из внешней сети.

![[Pasted image 20250804215222.png]]


**1. Экранирующий маршрутизатор (Сетевой уровень - L3 OSI)**

- **Уровень:** Сетевой (Network Layer - L3).
    
- **Суть:** Это самый базовый тип МЭ. Работает как **пакетный фильтр**.
    
- **Принцип работы:**
    
    - Принимает решение **разрешить/запретить** прохождение пакета **на основе информации в заголовках сетевого (L3) и транспортного (L4) уровней**:
        
        - IP-адрес источника и назначения.
            
        - Протокол транспортного уровня (TCP, UDP, ICMP).
            
        - Порт источника и назначения (для TCP/UDP).
            
        - Флаги (например, SYN, ACK для TCP).
            
    - **Не отслеживает состояние соединений.** Каждый пакет проверяется изолированно.
        
- **Аналогия:** Швейцар, проверяющий только адрес на конверте и тип письма (заказное/обычное), но не заглядывающий внутрь.
    
- **Плюсы:** Простота, высокая скорость обработки.
    
- **Минусы:**
    
    - Уязвим к IP-спуфингу (подделке адресов).
        
    - Не понимает контекст соединения (например, разрешит любой входящий пакет с флагом ACK, даже если не было исходящего SYN).
        
    - Не анализирует содержимое пакета (не видит угрозы внутри разрешенного протокола/порта).
        
    - Сложность управления большим набором правил (ACL).
        
- **Пример:** Стандартные ACL на маршрутизаторах Cisco (`access-list`).
    

**2. Шлюз сеансового уровня / Экранирующий транспорт (Сеансовый/Транспортный уровень - L5/L4 OSI)**

- **Уровень:** Сеансовый (Session Layer - L5) **и** Транспортный (Transport Layer - L4). На практике основная работа ведется на **Транспортном уровне (L4)** с отслеживанием _состояния сеанса_, что является функцией сеансового уровня (L5).
    
- **Суть:** Это **состоятельный (stateful) межсетевой экран**.
    
- **Принцип работы:**
    
    - Фильтрует пакеты на основе L3/L4 информации (как маршрутизатор), **НО**:
        
    - **Отслеживает состояние соединений (сессий).** Запоминает контекст установленных разрешенных соединений (например, что внутренний хост отправил SYN на внешний сервер, и получил SYN-ACK).
        
    - **Динамически управляет правилами:** Автоматически разрешает обратный трафик (ответы) для установленных легитимных сессий, даже если нет явного правила "разрешить входящий". Блокирует трафик, не соответствующий ожидаемому состоянию сессии.
        
- **Аналогия:** Швейцар, который не только проверяет конверт, но и ведет журнал: "Хост А отправил запрос хосту Б, ожидается ответ. Ответ от Б к А - разрешить. Письмо от В к А без предварительного запроса - заблокировать".
    
- **Плюсы:**
    
    - Гораздо безопаснее пакетного фильтра.
        
    - Эффективно блокирует спуфинг и нелегитимный трафик.
        
    - Защищает от некоторых атак (например, SYN-flood).
        
- **Минусы:**
    
    - Все еще не анализирует содержимое пакетов _прикладного уровня_ (L7).
        
    - Ресурсоемкость (требует памяти для хранения таблиц состояний).
        
- **Пример:** Классические stateful firewalls (ранние версии Cisco PIX/ASA, Check Point FireWall-1 Stateful Inspection).
    

**3. Шлюз прикладного уровня / Экранирующий шлюз (Прикладной уровень - L7 OSI)**

- **Уровень:** Прикладной (Application Layer - L7).
    
- **Суть:** Это **прокси-сервер (proxy) прикладного уровня**.
    
- **Принцип работы:**
    
    - **Выступает в роли посредника (proxy)** между клиентом и сервером.
        
    - Клиент устанавливает соединение **с самим прокси**.
        
    - Прокси **полностью принимает пакет**, **анализирует содержимое прикладного уровня** (L7) конкретного протокола (HTTP, FTP, SMTP, DNS и т.д.).
        
    - Проверяет данные на соответствие политикам безопасности и RFC протокола.
        
    - **Если данные безопасны,** прокси устанавливает **новое, отдельное соединение** от своего имени к целевому серверу и передает запрос. Ответ от сервера получает прокси, проверяет его и передает клиенту.
        
    - **Клиент и сервер "не видят" друг друга напрямую.**
        
- **Аналогия:** Личный секретарь. Клиент передает просьбу секретарю. Секретарь проверяет просьбу на соответствие правилам, при необходимости редактирует, _сам_ идет к нужному человеку (серверу), передает просьбу, получает ответ, проверяет его и отдает клиенту.
    
- **Плюсы:**
    
    - Максимальная безопасность и контроль.
        
    - Глубокий анализ содержимого: может обнаруживать и блокировать сложные атаки уровня приложений (SQLi, XSS, Path Traversal, инъекции команд, вредоносные вложения/ссылки).
        
    - Возможность фильтрации контента, кэширования, аутентификации пользователей.
        
    - Сокрытие внутренней структуры сети (клиент видит только прокси).
        
- **Минусы:**
    
    - Высокая ресурсоемкость (обработка всего трафика на L7).
        
    - Значительные задержки (latency).
        
    - Требует отдельного прокси-модуля для _каждого_ поддерживаемого прикладного протокола (HTTP-proxy, FTP-proxy и т.д.).
        
    - Сложность конфигурации и управления.
        
- **Пример:** Специализированные прокси-серверы (Squid для HTTP/HTTPS, специальные SMTP-шлюзы), функциональность Application Proxy в современных NGFW.